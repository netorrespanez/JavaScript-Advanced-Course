<template>
  <div>
    <div class="title">{{ $t('subtitles.country') }}</div>
    <data-switch-uk style="margin:auto;margin-bottom:10px;" v-model="tag"></data-switch-uk>
    <div class="mBlock" v-if="dataUk">
      <div class="overview">
        <div class="overview_item">
          <div class="overview_title">{{ $t('england') }}</div>
          <div class="overview_number"><ICountUp :options="countOpt" :endVal='getCumData("England")'/></div>
          <div class="country-death">{{ getNewData("England") }}</div>
        </div>
        <div class="overview_item">
          <div class="overview_title">{{ $t('scotland') }}</div>
          <div class="overview_number"><ICountUp :options="countOpt" :endVal='getCumData("Scotland")'/></div>
          <div class="country-death">{{ getNewData("Scotland") }}</div>
        </div>
        <div class="overview_item">
          <div class="overview_title">{{ $t('wales') }}</div>
          <div class="overview_number"><ICountUp :options="countOpt" :endVal='getCumData("Wales")'/></div>
          <div class="country-death">{{ getNewData("Wales") }}</div>
        </div>
        <div class="overview_item">
          <div class="overview_title">{{ $t('nIreland') }}</div>
          <div class="overview_number"><ICountUp :options="countOpt" :endVal='getCumData("Northern Ireland")'/></div>
          <div class="country-death">{{ getNewData("Northern Ireland") }}</div>
        </div>
      </div>
    </div>
    <Loading v-else></Loading>
  </div>
</template>

<script>
import Loading from "../common/Loading.vue";
import DataSwitchUk from "./DataSwitchUk.vue";
import ICountUp from 'vue-countup-v2';

export default {
  name: "UkRegionSection",
  props: ["dataUk"],
  data() {
    return {
      tag: "confirmed",
      countOpt: {
        duration: 0.5
      }
    };
  },
  components: {
    DataSwitchUk,
    Loading,
    ICountUp
  },
  methods: {
    getCumData(nation) {
      let data = this.dataUk.filter((e) => e.areaName === nation);
      return data[0][this.tag] ?? data[1][this.tag] ?? data[2][this.tag] ?? "-";
    },
    getNewData(nation) {
      let data = this.dataUk.filter((e) => e.areaName === nation);
      let newData = data[0][this.tag + "New"];
      if (newData) return "+" + newData;
      const today = data[0][this.tag];
      const yesterday = data[1][this.tag];
      if (!today) return "+0";
      if (!yesterday) return "-";
      const diff = today - yesterday;
      return (diff > 0 ? "+" : "") + diff.toFixed(0);
    },
  },
};
</script>

<style scoped>
</style>